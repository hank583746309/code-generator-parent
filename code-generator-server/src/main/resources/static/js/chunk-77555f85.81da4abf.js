(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77555f85","chunk-3dfc71ae","chunk-418da8a0"],{"1ca4":function(e,t,a){"use strict";var s=a("7c75"),l=a.n(s);l.a},2099:function(e,t,a){},"7c75":function(e,t,a){},"8d91":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main",staticStyle:{width:"100%",padding:"10px 20px"}},[a("a-form",{staticClass:"operator-area",attrs:{layout:"inline"}},[a("a-form-item",{staticStyle:{"margin-bottom":"0px !important"},attrs:{label:"基础配置"}},[a("a-input-group",[a("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"作者",size:"small"},model:{value:e.configParams.author,callback:function(t){e.$set(e.configParams,"author",t)},expression:"configParams.author"}}),a("a-input",{staticStyle:{width:"150px"},attrs:{placeholder:"包名",size:"small"},model:{value:e.configParams.package,callback:function(t){e.$set(e.configParams,"package",t)},expression:"configParams.package"}}),a("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"模块名",size:"small"},model:{value:e.configParams.moduleName,callback:function(t){e.$set(e.configParams,"moduleName",t)},expression:"configParams.moduleName"}})],1)],1),a("a-form-item",{staticStyle:{"margin-bottom":"0px !important"},attrs:{label:"策略配置"}},[a("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"移除前缀，多个前缀逗号分隔",size:"small",allowClear:""},model:{value:e.configParams.tablePrefix,callback:function(t){e.$set(e.configParams,"tablePrefix",t)},expression:"configParams.tablePrefix"}}),a("a",{staticStyle:{"vertical-align":"middle"},attrs:{title:"更多设置",disabled:""}},[a("a-icon",{staticStyle:{"margin-left":"10px"},attrs:{type:"setting"}})],1)],1),a("a-form-item",{staticStyle:{float:"right","margin-bottom":"0px !important","margin-right":"0px !important"}},[a("a-button",{attrs:{size:"small",type:"primary",disabled:e.disabled,loading:e.generatorLoading},on:{click:e.generator}},[a("a-icon",{attrs:{type:"code"}}),e._v("生 成")],1),a("a-button",{staticClass:"button",attrs:{size:"small",disabled:e.disabled},on:{click:e.down}},[a("a-icon",{attrs:{type:"download"}}),e._v("打包下载")],1)],1)],1),a("a-divider",{staticStyle:{margin:"6px 0 0"}}),a("a-tabs",{staticClass:"gen-tab",staticStyle:{"padding-bottom":"4px"},attrs:{size:"small"},model:{value:e.tabPanel,callback:function(t){e.tabPanel=t},expression:"tabPanel"}},[a("a-tab-pane",{key:"sql",attrs:{disabled:"sql"!==e.dataFrom}},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"code",size:"small"}}),e._v("SQL语句")],1),a("ddl-panel",{ref:"sqlTabPanel",attrs:{value:e.dfSql},on:{change:e.sqlPanelChange}})],1),a("a-tab-pane",{key:"datasource",attrs:{disabled:!0}},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"database"}}),e._v("数据源")],1)]),a("a-tab-pane",{key:"tpl",attrs:{"force-render":""}},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"appstore",size:"small"}}),e._v(" 模版项")],1),a("tpl-source-panel",{ref:"tplTabPanel",on:{"select-change":e.tplSelectChange}})],1),a("template",{slot:"tabBarExtraContent"},[a("a-select",{directives:[{name:"show",rawName:"v-show",value:"sql"===e.tabPanel,expression:"tabPanel === 'sql'"}],staticStyle:{width:"150px"},attrs:{size:"small"},model:{value:e.dbType,callback:function(t){e.dbType=t},expression:"dbType"}},e._l(e.dbTypes,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],2),a("code-preview",{ref:"codePreview",attrs:{tpls:e.selectTpls}})],1)},l=[],n=(a("c975"),a("ac1f"),a("466d"),a("5319"),a("1276"),a("f72c")),i=a("a958"),c=a("b60d"),r={name:"CodeGen",components:{DdlPanel:n["default"],TplSourcePanel:i["default"],CodePreview:c["default"]},data:function(){var e="CREATE TABLE 't_userinfo' (\n  'user_id' int(11) NOT NULL AUTO_INCREMENT COMMENT '用户ID',\n  'user_name' varchar(255) NOT NULL COMMENT '用户名',\n  'add_time' datetime NOT NULL COMMENT '创建时间',\n  PRIMARY KEY ('user_id')\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户信息';\n";return{dataFrom:"sql",tabPanel:"sql",dbType:"mysql",dbTypes:[{value:"mysql",label:"MySQL"},{value:"postgresql",label:"PostgreSQL"},{value:"oracle",label:"Oracle"},{value:"sqlserver",label:"SQL Server"}],dfSql:e,changeSql:e,queryParams:{sourceRow:{}},sourceDataSource:[],sourceSchemas:[],sourceTables:[],sourceSelectTables:[],cache:{table:{},schema:{}},selectTpls:[],configParams:{author:"hank",package:"com.hoo.project",tablePrefix:"t_"},generatorLoading:!1}},computed:{disabled:function(){return"sql"===this.dataFrom?this.changeSql.replace(/\n/g,"").match(/^[ ]*$/):"datasource"===this.dataFrom&&0===this.sourceSelectTables.length}},methods:{down:function(){this.$refs.codePreview.download()},generator:function(){var e={};"sql"===this.dataFrom?(e=Object.assign({sqlDdl:this.changeSql,dbType:this.dbType},this.configParams),e.tablePrefix=e.tablePrefix.split(",")):this.dataFrom,this.generatorLoading=!0,this.$refs.codePreview.reload(e,(function(e){this.generatorLoading=!1,e&&(this.tabPanel="tpl")}),this)},dataFromChange:function(){this.dataFrom!==this.tabPanel&&["datasource","sql"].indexOf(this.tabPanel)>-1&&(this.tabPanel=this.dataFrom)},sqlPanelChange:function(e){this.changeSql=e},datasourcePanelChange:function(e){this.sourceSelectTables=e},tplSelectChange:function(e){this.selectTpls=e},sourceSelectChange:function(e,t,a){delete this.queryParams.sourceSchema,this.sourceSchemas=[],this.privateSchemaSelectChange(a),this.privateSelectChange(this.queryParams.sourceRow=a)},sourceSchemaSelectChange:function(e,t,a){this.privateSelectChange(this.queryParams.sourceRow)},privateSelectChange:function(e){},privateSchemaSelectChange:function(e){}}},o=r,u=(a("930e"),a("2877")),p=Object(u["a"])(o,s,l,!1,null,null,null);t["default"]=p.exports},"930e":function(e,t,a){"use strict";var s=a("2099"),l=a.n(s);l.a},a958:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-tabs",{staticStyle:{"min-height":"200px"},attrs:{"default-active-key":"1","tab-position":"left"}},[a("a-tab-pane",{key:"1",attrs:{tab:"默认"+(0===e.systemSelectNum?"":"("+e.systemSelectNum+")"),"force-render":""}},[a("tpl-select",{attrs:{access:"system"},on:{change:e.systemChange}})],1),a("a-tab-pane",{key:"2",attrs:{tab:"公开"+(0===e.publicSelectNum?"":"("+e.publicSelectNum+")"),disabled:!0}},[a("tpl-select",{attrs:{access:"public"},on:{change:e.publicChange}})],1),a("a-tab-pane",{key:"3",attrs:{tab:"我的"+(0===e.privateSelectNum?"":"("+e.privateSelectNum+")"),disabled:!0}},[a("tpl-select",{attrs:{access:"private"},on:{change:e.privateChange}})],1)],1)},l=[],n=(a("99af"),a("c386")),i={name:"TplSourcePanel",components:{TplSelect:n["default"]},data:function(){return{systemSelectNum:0,publicSelectNum:0,privateSelectNum:0,select:{system:[],public:[],private:[]}}},methods:{systemChange:function(e){this.systemSelectNum=e.length,this.select.system=e,this.fireChange()},publicChange:function(e){this.publicSelectNum=e.length,this.select.public=e,this.fireChange()},privateChange:function(e){this.privateSelectNum=e.length,this.select.private=e,this.fireChange()},fireChange:function(){var e=[];for(var t in this.select)e=e.concat(this.select[t]);this.$emit("select-change",e)}}},c=i,r=a("2877"),o=Object(r["a"])(c,s,l,!1,null,"19eecc38",null);t["default"]=o.exports},c386:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tpl-select-container"},e._l(e.groupTpls,(function(t){return a("div",{key:t.groupId,staticClass:"group-container"},[a("div",{staticClass:"group-title"},[e._v(e._s(t.groupName))]),a("a-checkbox-group",{attrs:{size:"small"},on:{change:e.onChange},model:{value:e.values,callback:function(t){e.values=t},expression:"values"}},e._l(t.items,(function(t){return a("a-checkbox",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)})),0)},l=[],n=(a("4160"),a("c975"),a("d3b7"),a("159b"),a("ddb0"),{name:"TplSelect",props:{access:{type:String,default:"system"}},data:function(){return{loading:!1,values:[],dataSource:[],groupTpls:[]}},mounted:function(){this.fetch()},methods:{fetch:function(){var e=this;this.loading=!0,this.$http.get("api/tpl/all",{}).then((function(t){e.loading=!1,e.dataSource=t.data||[];var a={},s=[];for(var l in e.dataSource.forEach((function(e,t){a[e.groupId]||(a[e.groupId]={groupId:e.groupId,groupName:e.groupName,items:[]}),a[e.groupId]["items"].push({label:e.title,value:e.tplId})})),a)s.push(a[l]);e.groupTpls=s,e.dataSource.length>0&&"system"===e.access&&(e.$emit("change",[e.dataSource[0]]),e.values=[e.dataSource[0]["tplId"]])})).catch((function(t){e.loading=!1}))},onChange:function(e){var t=[];this.dataSource.forEach((function(a){e.indexOf(a.tplId)>-1&&t.push(a)})),this.$emit("change",t)}}}),i=n,c=(a("1ca4"),a("2877")),r=Object(c["a"])(i,s,l,!1,null,null,null);t["default"]=r.exports}}]);